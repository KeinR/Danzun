
function wait(sec)
    coroutine.yield(sec)
end

function spawn(x, y, vx, vy)
    local e = game:spawnEntityFull(
        function(other)
            print ("nice hit!")
        end,
        entConf,
        [[
            x += dt * m * 10 * vx;
            y += dt * m * 10 * vy;
        ]],
        {
            bvars
        },
        {
            vx = vx,
            vy = vy
        },
        x, y,
        10, 10,
        false
    );
    e:setScript(function(e)
        while true do
            game:spawnEntityFull(
                function(other)
                    print ("nice hit!")
                end,
                conf,
                [[
                    var target[2] := { 100, 100 };
                    var v[2] := { vx, vy };
                    var n[2] := target - p;
                    n := n / hypot(n[0], n[1]);
                    p := p + n * 10 * dt;
                ]],
                {},
                {
                    vx = vx,
                    vy = vy
                },
                e:getX(), e:getY(),
                10, 10,
                false
            );
            wait(1);
        end
    end);
end

spawn(40, 0, -0.5, 1)
spawn(80, 0, 0.5, 1)

wait(50)

-- spawn()

-- wait(5)

-- spawn()
